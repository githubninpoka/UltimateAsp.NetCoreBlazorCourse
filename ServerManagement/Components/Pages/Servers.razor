@page "/"
@page "/servers"

@inject NavigationManager NavigationManager
@rendermode InteractiveServer // this brings the entire (routable) component under the control of the server interactively.


<br />
<CityListComponent 
    @rendermode="InteractiveServer"
    @ref="cityListComponent"
    SelectCityCallback="HandleCitySelection"></CityListComponent>

<SearchServerComponent 
    @rendermode="InteractiveServer"
    @ref="searchServerComponent"
    OnSearchPerformedCallback="HandleSearch"
    />

<ServerListComponent 
    @rendermode="InteractiveServer" 
    CityName="@_selectedCity"
    SearchString="@_searchString"
    />


@code {
    private CityListComponent? cityListComponent;
    private SearchServerComponent? searchServerComponent;

    private string _selectedCity = "Toronto";

    private string _searchString = "";

    private void HandleCitySelection(string selectedCity)
    {
        _selectedCity = selectedCity;
        _searchString = string.Empty;
        searchServerComponent?.ClearSearchFilter();
    }

    private void HandleSearch(string searchString)
    {
        _searchString = searchString;
        cityListComponent?.ClearCitySelection();
    }
}
